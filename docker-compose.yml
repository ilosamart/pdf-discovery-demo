# Docker compose file for the application.

version: '3'
services:

  app:
    build: ./app
    #volumes:
      #- .:/srv/app
    ports:
      - 8080:8080
    links:
      - solr

  zookeeper:
    image: jplock/zookeeper
    ports:
      - "2181:2181"
      - "2888:2888"
      - "3888:3888"

  solr:
    build: ./solr
    ports:
     - "8983:8983"
    links:
      - zookeeper
    command: "bash -c '/opt/solr/bin/solr start -f -z zookeeper:2181 -Dbootstrap_confdir=/solr-config/index/conf'"

  solr-proxy:
    build: ./solr-proxy
    ports:
      - "8000:80"
    links:
      - solr

  init:
    build:
      context: ./ocr
      dockerfile: init/Dockerfile
    ports:
     - "8443:8443"
    links:
      - solr
      - zookeeper

  tika-t3:
    build:
      context: ./tika-server-tesseract-3
    image: osc/tika-server-tesseract-3
    ports:
      - "9988:9988"

  tika:
    image: logicalspark/docker-tikaserver
    ports:
      - "9998:9998"

<?xml version="1.0" ?>

<schema name="documents" version="1.1">

    <!--
        Fields
    -->

    <field name="id" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="doc_id" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="content_type" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="title" type="text" indexed="true" stored="true" multiValued="false" />
    <field name="content" type="text" indexed="true" stored="true" multiValued="false" />
    <field name="content_ocr" type="ocr" indexed="true" stored="true" multiValued="false" termPayloads="true" termOffsets="true" termPositions="true" termVectors="true" />

    <field name="page_dimensions" type="string" indexed="false" stored="true" multiValued="false" />

    <field name="path" type="string" indexed="false" stored="true" multiValued="false" />


    <field name="publish_date" type="date" indexed="true" stored="true" multiValued="false" />

    <!--
        Copy fields
    -->

    <!--
        Internal schema configuration settings
    -->
    <field name="_root_" type="string" indexed="true" stored="false"/>

    <!-- Used by Solr for optimistic concurrency -->
    <field name="_version_" type="long" indexed="true" stored="true"/>

    <!-- field to use to determine and enforce document uniqueness. -->
    <uniqueKey>id</uniqueKey>

    <!-- field for the QueryParser to use when an explicit fieldname is absent -->
    <defaultSearchField>content_ocr</defaultSearchField>

    <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
    <solrQueryParser defaultOperator="OR"/>

    <!--
        Field Types
    -->
    <!-- OCR Payloads -->
    <fieldType name="ocr" stored="false" indexed="true" class="solr.TextField">
      <analyzer>
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.DelimitedPayloadTokenFilterFactory" encoder="identity" />
        <filter class="org.osc.ocr.filter.StickPayloadFilterFactory" />
        <filter class="solr.LowerCaseFilterFactory" />
        <filter class="solr.WordDelimiterFilterFactory" />
        <filter class="org.osc.ocr.filter.UnstickPayloadFilterFactory" />
      </analyzer>
    </fieldType>

    <!-- Simple text analysis -->
    <fieldType name="text" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldType>

    <!-- Beider-Morse Phonetic Matching (BMPM) is better at matching names -->
    <fieldType name="bmpm" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.BeiderMorseFilterFactory" nameType="GENERIC" ruleType="APPROX" concat="true" languageSet="auto"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.BeiderMorseFilterFactory" nameType="GENERIC" ruleType="APPROX" concat="true" languageSet="auto"/>
      </analyzer>
    </fieldType>

    <!-- Simple types -->
    <fieldtype name="string" class="solr.StrField"      sortMissingLast="true" omitNorms="true"/>
    <fieldType name="long"   class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
    <fieldType name="int"    class="solr.TrieIntField"  precisionStep="8" positionIncrementGap="0"/>
    <fieldType name="date"   class="solr.TrieDateField" precisionStep="6" positionIncrementGap="0"/>

</schema>
